<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–¢–∞–±–ª–∏—Ü–∞ –í–ª–∞–¥–∏—Å–ª–∞–≤–∞ –ì–µ–∫–∫–µ–ª—è</title>

  <style>
    body {
      font-family: "Inter", sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
    }

    table {
      border-collapse: collapse;
      background: white;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 1300px;
      border-radius: 8px;
      overflow: hidden;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 8px 12px;
      text-align: center;
    }

    th {
      background: #eaeaea;
      font-weight: 600;
    }

    tr:nth-child(even) {
      background: #fafafa;
    }

    @media (max-width: 768px) {
      body {
        padding: 5px;
      }
      table {
        font-size: 12px;
        width: 100%;
      }
      th, td {
        padding: 4px 6px;
      }
    }
  </style>
</head>

<body>
  <table id="sheet-table">
    <thead></thead>
    <tbody></tbody>
  </table>

  <script>
    const sheetUrl = "https://script.google.com/macros/s/AKfycbyJ8Nv2dVp0TNXTDAi9RMaaqe80NEYg9Bwp4QkVOBBqINJCQSVKSY2G_VlLSaHDrqCrOA/exec";

    async function loadData() {
      try {
        const response = await fetch(sheetUrl);
        const data = await response.json();

        const table = document.getElementById("sheet-table");
        const thead = table.querySelector("thead");
        const tbody = table.querySelector("tbody");

        // –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –∑–∞–≥–æ–ª–æ–≤–∫–∏
        const headers = data[0];
        thead.innerHTML = "<tr>" + headers.map(h => `<th>${h}</th>`).join("") + "</tr>";

        // –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ ‚Äî –¥–∞–Ω–Ω—ã–µ
        tbody.innerHTML = "";
        data.slice(1).forEach(row => {
          tbody.innerHTML += "<tr>" + row.map(c => `<td>${c}</td>`).join("") + "</tr>";
        });
      } catch (error) {
        console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:", error);
        document.body.innerHTML = "<p style='color:red;text-align:center;'>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ.</p>";
      }
    }

    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    loadData();

    // üîÅ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
    setInterval(loadData, 60000);
  </script>
</body>
</html>
